name: kk-app CI

on:
  push:
    branches:
      - action-test

jobs:
  build:
    runs-on: windows-latest
    permissions:
      contents: read
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          submodules: 'true'

      - name: Add msbuild to PATH
        uses: microsoft/setup-msbuild@v2

      - name: Install Vulkan SDK
        uses: humbletim/install-vulkan-sdk@v1.1.1
        with:
          version: 1.3.204.1
          cache: true

      - name: Install Vulkan SDK
        uses: jakoch/install-vulkan-sdk-action@v1.0.0
        with:
          vulkan_version: 1.3.231.1
          install_runtime: true
          cache: true
          stripdown: true

#      - name: Set up vcpkg
#        run: |
#          git clone https://github.com/microsoft/vcpkg.git
#          cd vcpkg
#          ./bootstrap-vcpkg.sh
      - name: Install Ninja
        uses: turtlesec-no/get-ninja@main
#      - name: debugger
#        uses: csexton/debugger-action@master
#      - name: Install dependencies
#        run: |
#          ./vcpkg/vcpkg install --x-manifest-root=.
      - name: Configure CMake
        run: |
          mkdir build
          cmake -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_TOOLCHAIN_FILE=../vcpkg/scripts/buildsystems/vcpkg.cname -G Ninja -S . -B build
      - name: Build with Ninja
        run: |
          cd build
          ninja
#      - name: Create Release
#        id: create_release
#        uses: softprops/action-gh-release@v1
#